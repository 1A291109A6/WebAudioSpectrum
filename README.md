# WebAudioSpectrum
端末上の音声ファイルを**オーディオスペクトラム**で同期させて再生できます。いくつかの**高速化**を行っているため軽量で動作します。**Web Audio APIでFFT**をせず、FFTの処理は自作しています。

https://web-audio-spectrum.netlify.app/

## 使い方
1. **ファイルを選択**を押して、MP3ファイルを選択(現在MP3のみ)
2. 「Music loaded!!」と出るまで待つ
3. **青いボタン**「**Play**」を押して再生
4. **青いボタン**「**Stop**」を押して停止、リセット
5. **画面下の赤色のバー**で任意の場所から再生

## 設定
**Bar settings**
  - **Bar thickness**でバーの太さを変更
  - **Gain**でバーの感度を変更
  - **Moveボタン**で音楽に合わせてバーを拡大、縮小する
  - **Moveボタンの下のGain**で拡大する大きさを変更
  - **Moveボタンの下のThreshold**で拡大、縮小のしやすさを変更

**Bass reduction**
  - 低音の感度を下げる(これをONにしないと低音部分が大きく表示される)

**Bar color**
  - **Red、Green、Blue**でバーの色の赤色、緑色、青色成分の強さを変更

## 高速化の詳細
  - **DFT**(**離散フーリエ変換**)ではなく**FFT**(**高速フーリエ変換**)を使う
  - 毎フレームFFTで三角関数を計算するのではなく**先に計算結果を保存**しておき、その数値を使う(三角関数の計算コスト削減)
  - **窓関数も先に計算結果を保存**しておき、その数値を使う
  - 60FPSで描画されるが**30FPSでFFT処理を行い、フレーム補間**をして描画する
  - サイズ1024でFFTするのではなく、ガウス畳み込みによるローパスフィルタをかけ、**ダウンサンプリング後にサイズ256でFFT**する
